Configuring TIM1 as a PWM driver, so that I can use it to generate test signals for building out the rain sensor droplet pulse capture.

Important tip about configuring, starting, and re-configuring the PWM 
https://electronics.stackexchange.com/questions/179546/getting-pwm-to-work-on-stm32f4-using-sts-hal-libraries

Current development plan:

Implement a 50% duty cycle PWM output, and test this using logic analyzer.  
Should be able to change the PWM frequency using the preload value (? verify)

Some PWM tutorial using HAL here:
https://embeddedthere.com/stm32-pwm-tutorial-hal-example-code-included/

Setup a timer as an input capture with a large (over 5000) overflow value.  possibly use all 16 bits of the counter?

Use timer DMA to get the timer value out using a timed interrupt (another counter? RTC?) and store it in a buffer.  Unsure of the frequency we would need to do this at, but the rating of the rain sensor is s^{-1}.  

The rain sensor also has a "raining" status output and an analog voltage.

The analog voltage is 1-3VDC, so is suitable for direct input to the STM32 with proper IO protection in place.  The voltage is proportional to the amount of wetted surface on the detector.

This sensor is not sufficient for precipitation measurement, but would assist in gating a more traditional style rain sensor.  A "rain gauge" will be required to get rainfall volume.

Additionally, there is currently no barometric pressure sensor.  One of these will be required also.

The heated surface protects against false triggering from condensation or dew.  This heater should probably be triggered by calculated dewpoint and/or other possible cues.

Set the PWM pulse to 4096, with no prescaling and a full value count before rollover.  Have not calculated what that will get us.  

The pulse value sets the width of the pulse, need to read more detail about adjusting the actual frequency.